import { loadFixture } from "@nomicfoundation/hardhat-toolbox/network-helpers";
import { anyValue } from "@nomicfoundation/hardhat-chai-matchers/withArgs";
import { expect } from "chai";
import { ethers } from "hardhat";
import { any } from "hardhat/internal/core/params/argumentTypes";

describe("Verifier", function () {
  it("isValidSignature", async function () {
    const [signer] = await ethers.getSigners();

    const Verifier = await ethers.getContractFactory("Verifier");
    const verifier = await Verifier.deploy();

    const credentialId = "RgzLSZ3qQP7za4-nh54Vmw";
    const pubX =
      46391394249131874636236276047167003928220604990198447323151308919417359013058n;
    const pubY =
      45936474664489387420491585713223435025917814782187752218700791814407654804701n;

    await verifier.setPubKey(credentialId, pubX, pubY);
    expect(await verifier.pubKey()).to.deep.equal([credentialId, pubX, pubY]);

    const ret = await verifier.isValidSignature(
      "0x1c8aff950685c2ed4bc3174f3472287b56d9517b9c948127319a09a7a36deac8",
      "0xf1187afef559f1d981d1156b1241d5ff1ebcfb367e785576a7cc331a2cd29cb6a2838771531f3fa41a58e70838faf18ed88e808e9d17ae5af0e8811d9d91404600000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97631d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000247b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a22000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000037222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303030222c2263726f73734f726967696e223a66616c73657d000000000000000000"
    );
    console.log(ret);
  });
});
